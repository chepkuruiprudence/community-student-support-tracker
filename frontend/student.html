<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Dashboard | EduSupport</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 min-h-screen">

<!-- Auth check -->
<script>
const user = JSON.parse(localStorage.getItem("user"));
if (!user || !user.is_student) window.location.replace("index.html");
</script>

<!-- Navbar -->
<div id="navbar-container"></div>
<script src="navbar.js"></script>

<div class="container mx-auto p-6">
  <h2 class="text-2xl font-bold mb-6">My Needs Dashboard</h2>

  <!-- Create Need Card -->
  <div class="bg-white p-6 rounded shadow mb-6 w-full md:w-1/2">
    <h3 class="text-xl font-semibold mb-4">Create a New Need</h3>
    <input id="newNeedTitle" placeholder="Need Title" class="border p-2 w-full mb-2 rounded">
    <input id="newNeedAmount" placeholder="Amount Required" type="number" class="border p-2 w-full mb-2 rounded">
    <button id="createNeedBtn" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
      Create Need
    </button>
  </div>

  <!-- List of Needs -->
  <div id="needs" class="grid md:grid-cols-2 gap-4"></div>
</div>

<script src="app.js"></script>
<script>
  /* Create New Need */
  const createBtn = document.getElementById("createNeedBtn");
  if (createBtn) {
    createBtn.addEventListener("click", async () => {
      const title = document.getElementById("newNeedTitle").value;
      const amount_required = document.getElementById("newNeedAmount").value;
      if (!title || !amount_required) return alert("Fill all fields");

      const res = await fetch(`${API}/needs/`, {
        method: "POST",
        headers: authHeaders(),
        body: JSON.stringify({ title, amount_required })
      });

      if (!res.ok) return alert("Failed to create need");
      alert("Need created successfully!");
      document.getElementById("newNeedTitle").value = "";
      document.getElementById("newNeedAmount").value = "";
      loadStudent();
    });
  }

  // Load student needs
  if (document.getElementById("needs")) loadStudent();
</script>
</body>
</html>
